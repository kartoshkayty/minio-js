import * as http from "http";
import * as https from "https";
import { URL, URLSearchParams } from "url";
import { CredentialProvider } from "./CredentialProvider.mjs";
import { Credentials } from "./Credentials.mjs";
import { makeDateLong, parseXml, toSha256 } from "./internal/helper.mjs";
import { request } from "./internal/request.mjs";
import { readAsString } from "./internal/response.mjs";
import { signV4ByServiceName } from "./signing.mjs";

/**
 * @see https://docs.aws.amazon.com/STS/latest/APIReference/API_AssumeRole.html
 */

const defaultExpirySeconds = 900;
export class AssumeRoleProvider extends CredentialProvider {
  accessExpiresAt = '';
  constructor({
    stsEndpoint,
    accessKey,
    secretKey,
    durationSeconds = defaultExpirySeconds,
    sessionToken,
    policy,
    region = '',
    roleArn,
    roleSessionName,
    externalId,
    token,
    webIdentityToken,
    action = 'AssumeRole',
    transportAgent = undefined
  }) {
    super({
      accessKey,
      secretKey,
      sessionToken
    });
    this.stsEndpoint = new URL(stsEndpoint);
    this.accessKey = accessKey;
    this.secretKey = secretKey;
    this.policy = policy;
    this.region = region;
    this.roleArn = roleArn;
    this.roleSessionName = roleSessionName;
    this.externalId = externalId;
    this.token = token;
    this.webIdentityToken = webIdentityToken;
    this.action = action;
    this.durationSeconds = parseInt(durationSeconds);
    let expirySeconds = this.durationSeconds;
    if (this.durationSeconds < defaultExpirySeconds) {
      expirySeconds = defaultExpirySeconds;
    }
    this.expirySeconds = expirySeconds; // for calculating refresh of credentials.

    // By default, nodejs uses a global agent if the 'agent' property
    // is set to undefined. Otherwise, it's okay to assume the users
    // know what they're doing if they specify a custom transport agent.
    this.transportAgent = transportAgent;
    const isHttp = this.stsEndpoint.protocol === 'http:';
    this.transport = isHttp ? http : https;

    /**
     * Internal Tracking variables
     */
    this._credentials = null;
  }
  getRequestConfig() {
    const hostValue = this.stsEndpoint.hostname;
    const portValue = this.stsEndpoint.port;
    const qryParams = new URLSearchParams({
      Action: this.action,
      Version: '2011-06-15'
    });
    qryParams.set('DurationSeconds', this.expirySeconds.toString());
    if (this.policy) {
      qryParams.set('Policy', this.policy);
    }
    if (this.roleArn) {
      qryParams.set('RoleArn', this.roleArn);
    }
    if (this.roleSessionName != null) {
      qryParams.set('RoleSessionName', this.roleSessionName);
    }
    if (this.token != null) {
      qryParams.set('Token', this.token);
    }
    if (this.webIdentityToken) {
      qryParams.set('WebIdentityToken', this.webIdentityToken);
    }
    if (this.externalId) {
      qryParams.set('ExternalId', this.externalId);
    }
    const urlParams = qryParams.toString();
    const contentSha256 = toSha256(urlParams);
    const date = new Date();
    const requestOptions = {
      hostname: hostValue,
      port: portValue,
      path: '/',
      protocol: this.stsEndpoint.protocol,
      method: 'POST',
      headers: {
        'Content-Type': 'application/x-www-form-urlencoded',
        'content-length': urlParams.length.toString(),
        host: hostValue,
        'x-amz-date': makeDateLong(date),
        'x-amz-content-sha256': contentSha256
      },
      agent: this.transportAgent
    };
    requestOptions.headers.authorization = signV4ByServiceName(requestOptions, this.accessKey, this.secretKey, this.region, date, contentSha256, 'sts');
    return {
      requestOptions,
      requestData: urlParams
    };
  }
  async performRequest() {
    const {
      requestOptions,
      requestData
    } = this.getRequestConfig();
    const res = await request(this.transport, requestOptions, requestData);
    const body = await readAsString(res);
    return parseXml(body);
  }
  parseCredentials(respObj) {
    if (respObj.ErrorResponse) {
      var _respObj$ErrorRespons, _respObj$ErrorRespons2;
      throw new Error(`Unable to obtain credentials: ${(_respObj$ErrorRespons = respObj.ErrorResponse) === null || _respObj$ErrorRespons === void 0 || (_respObj$ErrorRespons = _respObj$ErrorRespons.Error) === null || _respObj$ErrorRespons === void 0 ? void 0 : _respObj$ErrorRespons.Code} ${(_respObj$ErrorRespons2 = respObj.ErrorResponse) === null || _respObj$ErrorRespons2 === void 0 || (_respObj$ErrorRespons2 = _respObj$ErrorRespons2.Error) === null || _respObj$ErrorRespons2 === void 0 ? void 0 : _respObj$ErrorRespons2.Message}`, {
        cause: respObj
      });
    }
    const {
      AssumeRoleResponse: {
        AssumeRoleResult: {
          Credentials: {
            AccessKeyId: accessKey,
            SecretAccessKey: secretKey,
            SessionToken: sessionToken,
            Expiration: expiresAt
          }
        }
      }
    } = respObj;
    this.accessExpiresAt = expiresAt;
    return new Credentials({
      accessKey,
      secretKey,
      sessionToken
    });
  }
  async refreshCredentials() {
    try {
      const assumeRoleCredentials = await this.performRequest();
      this._credentials = this.parseCredentials(assumeRoleCredentials);
    } catch (err) {
      throw new Error(`Failed to get Credentials: ${err}`, {
        cause: err
      });
    }
    return this._credentials;
  }
  async getCredentials() {
    if (this._credentials && !this.isAboutToExpire()) {
      return this._credentials;
    }
    this._credentials = await this.refreshCredentials();
    return this._credentials;
  }
  isAboutToExpire() {
    const expiresAt = new Date(this.accessExpiresAt);
    const provisionalExpiry = new Date(Date.now() + 1000 * 10); // check before 10 seconds.
    return provisionalExpiry > expiresAt;
  }
}

// deprecated default export, please use named exports.
// keep for backward compatibility.
// eslint-disable-next-line import/no-default-export
export default AssumeRoleProvider;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJodHRwIiwiaHR0cHMiLCJVUkwiLCJVUkxTZWFyY2hQYXJhbXMiLCJDcmVkZW50aWFsUHJvdmlkZXIiLCJDcmVkZW50aWFscyIsIm1ha2VEYXRlTG9uZyIsInBhcnNlWG1sIiwidG9TaGEyNTYiLCJyZXF1ZXN0IiwicmVhZEFzU3RyaW5nIiwic2lnblY0QnlTZXJ2aWNlTmFtZSIsImRlZmF1bHRFeHBpcnlTZWNvbmRzIiwiQXNzdW1lUm9sZVByb3ZpZGVyIiwiYWNjZXNzRXhwaXJlc0F0IiwiY29uc3RydWN0b3IiLCJzdHNFbmRwb2ludCIsImFjY2Vzc0tleSIsInNlY3JldEtleSIsImR1cmF0aW9uU2Vjb25kcyIsInNlc3Npb25Ub2tlbiIsInBvbGljeSIsInJlZ2lvbiIsInJvbGVBcm4iLCJyb2xlU2Vzc2lvbk5hbWUiLCJleHRlcm5hbElkIiwidG9rZW4iLCJ3ZWJJZGVudGl0eVRva2VuIiwiYWN0aW9uIiwidHJhbnNwb3J0QWdlbnQiLCJ1bmRlZmluZWQiLCJwYXJzZUludCIsImV4cGlyeVNlY29uZHMiLCJpc0h0dHAiLCJwcm90b2NvbCIsInRyYW5zcG9ydCIsIl9jcmVkZW50aWFscyIsImdldFJlcXVlc3RDb25maWciLCJob3N0VmFsdWUiLCJob3N0bmFtZSIsInBvcnRWYWx1ZSIsInBvcnQiLCJxcnlQYXJhbXMiLCJBY3Rpb24iLCJWZXJzaW9uIiwic2V0IiwidG9TdHJpbmciLCJ1cmxQYXJhbXMiLCJjb250ZW50U2hhMjU2IiwiZGF0ZSIsIkRhdGUiLCJyZXF1ZXN0T3B0aW9ucyIsInBhdGgiLCJtZXRob2QiLCJoZWFkZXJzIiwibGVuZ3RoIiwiaG9zdCIsImFnZW50IiwiYXV0aG9yaXphdGlvbiIsInJlcXVlc3REYXRhIiwicGVyZm9ybVJlcXVlc3QiLCJyZXMiLCJib2R5IiwicGFyc2VDcmVkZW50aWFscyIsInJlc3BPYmoiLCJFcnJvclJlc3BvbnNlIiwiX3Jlc3BPYmokRXJyb3JSZXNwb25zIiwiX3Jlc3BPYmokRXJyb3JSZXNwb25zMiIsIkVycm9yIiwiQ29kZSIsIk1lc3NhZ2UiLCJjYXVzZSIsIkFzc3VtZVJvbGVSZXNwb25zZSIsIkFzc3VtZVJvbGVSZXN1bHQiLCJBY2Nlc3NLZXlJZCIsIlNlY3JldEFjY2Vzc0tleSIsIlNlc3Npb25Ub2tlbiIsIkV4cGlyYXRpb24iLCJleHBpcmVzQXQiLCJyZWZyZXNoQ3JlZGVudGlhbHMiLCJhc3N1bWVSb2xlQ3JlZGVudGlhbHMiLCJlcnIiLCJnZXRDcmVkZW50aWFscyIsImlzQWJvdXRUb0V4cGlyZSIsInByb3Zpc2lvbmFsRXhwaXJ5Iiwibm93Il0sInNvdXJjZXMiOlsiQXNzdW1lUm9sZVByb3ZpZGVyLnRzIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCAqIGFzIGh0dHAgZnJvbSAnbm9kZTpodHRwJ1xyXG5pbXBvcnQgKiBhcyBodHRwcyBmcm9tICdub2RlOmh0dHBzJ1xyXG5pbXBvcnQgeyBVUkwsIFVSTFNlYXJjaFBhcmFtcyB9IGZyb20gJ25vZGU6dXJsJ1xyXG5cclxuaW1wb3J0IHsgQ3JlZGVudGlhbFByb3ZpZGVyIH0gZnJvbSAnLi9DcmVkZW50aWFsUHJvdmlkZXIudHMnXHJcbmltcG9ydCB7IENyZWRlbnRpYWxzIH0gZnJvbSAnLi9DcmVkZW50aWFscy50cydcclxuaW1wb3J0IHsgbWFrZURhdGVMb25nLCBwYXJzZVhtbCwgdG9TaGEyNTYgfSBmcm9tICcuL2ludGVybmFsL2hlbHBlci50cydcclxuaW1wb3J0IHsgcmVxdWVzdCB9IGZyb20gJy4vaW50ZXJuYWwvcmVxdWVzdC50cydcclxuaW1wb3J0IHsgcmVhZEFzU3RyaW5nIH0gZnJvbSAnLi9pbnRlcm5hbC9yZXNwb25zZS50cydcclxuaW1wb3J0IHR5cGUgeyBUcmFuc3BvcnQgfSBmcm9tICcuL2ludGVybmFsL3R5cGUudHMnXHJcbmltcG9ydCB7IHNpZ25WNEJ5U2VydmljZU5hbWUgfSBmcm9tICcuL3NpZ25pbmcudHMnXHJcblxyXG4vKipcclxuICogQHNlZSBodHRwczovL2RvY3MuYXdzLmFtYXpvbi5jb20vU1RTL2xhdGVzdC9BUElSZWZlcmVuY2UvQVBJX0Fzc3VtZVJvbGUuaHRtbFxyXG4gKi9cclxudHlwZSBDcmVkZW50aWFsUmVzcG9uc2UgPSB7XHJcbiAgRXJyb3JSZXNwb25zZT86IHtcclxuICAgIEVycm9yPzoge1xyXG4gICAgICBDb2RlPzogc3RyaW5nXHJcbiAgICAgIE1lc3NhZ2U/OiBzdHJpbmdcclxuICAgIH1cclxuICB9XHJcblxyXG4gIEFzc3VtZVJvbGVSZXNwb25zZToge1xyXG4gICAgQXNzdW1lUm9sZVJlc3VsdDoge1xyXG4gICAgICBDcmVkZW50aWFsczoge1xyXG4gICAgICAgIEFjY2Vzc0tleUlkOiBzdHJpbmdcclxuICAgICAgICBTZWNyZXRBY2Nlc3NLZXk6IHN0cmluZ1xyXG4gICAgICAgIFNlc3Npb25Ub2tlbjogc3RyaW5nXHJcbiAgICAgICAgRXhwaXJhdGlvbjogc3RyaW5nXHJcbiAgICAgIH1cclxuICAgIH1cclxuICB9XHJcbn1cclxuXHJcbmV4cG9ydCBpbnRlcmZhY2UgQXNzdW1lUm9sZVByb3ZpZGVyT3B0aW9ucyB7XHJcbiAgc3RzRW5kcG9pbnQ6IHN0cmluZ1xyXG4gIGFjY2Vzc0tleTogc3RyaW5nXHJcbiAgc2VjcmV0S2V5OiBzdHJpbmdcclxuICBkdXJhdGlvblNlY29uZHM/OiBudW1iZXJcclxuICBzZXNzaW9uVG9rZW4/OiBzdHJpbmdcclxuICBwb2xpY3k/OiBzdHJpbmdcclxuICByZWdpb24/OiBzdHJpbmdcclxuICByb2xlQXJuPzogc3RyaW5nXHJcbiAgcm9sZVNlc3Npb25OYW1lPzogc3RyaW5nXHJcbiAgZXh0ZXJuYWxJZD86IHN0cmluZ1xyXG4gIHRva2VuPzogc3RyaW5nXHJcbiAgd2ViSWRlbnRpdHlUb2tlbj86IHN0cmluZ1xyXG4gIGFjdGlvbj86IHN0cmluZ1xyXG4gIHRyYW5zcG9ydEFnZW50PzogaHR0cC5BZ2VudFxyXG59XHJcblxyXG5jb25zdCBkZWZhdWx0RXhwaXJ5U2Vjb25kcyA9IDkwMFxyXG5cclxuZXhwb3J0IGNsYXNzIEFzc3VtZVJvbGVQcm92aWRlciBleHRlbmRzIENyZWRlbnRpYWxQcm92aWRlciB7XHJcbiAgcHJpdmF0ZSByZWFkb25seSBzdHNFbmRwb2ludDogVVJMXHJcbiAgcHJpdmF0ZSByZWFkb25seSBhY2Nlc3NLZXk6IHN0cmluZ1xyXG4gIHByaXZhdGUgcmVhZG9ubHkgc2VjcmV0S2V5OiBzdHJpbmdcclxuICBwcml2YXRlIHJlYWRvbmx5IGR1cmF0aW9uU2Vjb25kczogbnVtYmVyXHJcbiAgcHJpdmF0ZSByZWFkb25seSBwb2xpY3k/OiBzdHJpbmdcclxuICBwcml2YXRlIHJlYWRvbmx5IHJlZ2lvbjogc3RyaW5nXHJcbiAgcHJpdmF0ZSByZWFkb25seSByb2xlQXJuPzogc3RyaW5nXHJcbiAgcHJpdmF0ZSByZWFkb25seSByb2xlU2Vzc2lvbk5hbWU/OiBzdHJpbmdcclxuICBwcml2YXRlIHJlYWRvbmx5IGV4dGVybmFsSWQ/OiBzdHJpbmdcclxuICBwcml2YXRlIHJlYWRvbmx5IHRva2VuPzogc3RyaW5nXHJcbiAgcHJpdmF0ZSByZWFkb25seSB3ZWJJZGVudGl0eVRva2VuPzogc3RyaW5nXHJcbiAgcHJpdmF0ZSByZWFkb25seSBhY3Rpb246IHN0cmluZ1xyXG5cclxuICBwcml2YXRlIF9jcmVkZW50aWFsczogQ3JlZGVudGlhbHMgfCBudWxsXHJcbiAgcHJpdmF0ZSByZWFkb25seSBleHBpcnlTZWNvbmRzOiBudW1iZXJcclxuICBwcml2YXRlIGFjY2Vzc0V4cGlyZXNBdCA9ICcnXHJcbiAgcHJpdmF0ZSByZWFkb25seSB0cmFuc3BvcnRBZ2VudD86IGh0dHAuQWdlbnRcclxuXHJcbiAgcHJpdmF0ZSByZWFkb25seSB0cmFuc3BvcnQ6IFRyYW5zcG9ydFxyXG5cclxuICBjb25zdHJ1Y3Rvcih7XHJcbiAgICBzdHNFbmRwb2ludCxcclxuICAgIGFjY2Vzc0tleSxcclxuICAgIHNlY3JldEtleSxcclxuICAgIGR1cmF0aW9uU2Vjb25kcyA9IGRlZmF1bHRFeHBpcnlTZWNvbmRzLFxyXG4gICAgc2Vzc2lvblRva2VuLFxyXG4gICAgcG9saWN5LFxyXG4gICAgcmVnaW9uID0gJycsXHJcbiAgICByb2xlQXJuLFxyXG4gICAgcm9sZVNlc3Npb25OYW1lLFxyXG4gICAgZXh0ZXJuYWxJZCxcclxuICAgIHRva2VuLFxyXG4gICAgd2ViSWRlbnRpdHlUb2tlbixcclxuICAgIGFjdGlvbiA9ICdBc3N1bWVSb2xlJyxcclxuICAgIHRyYW5zcG9ydEFnZW50ID0gdW5kZWZpbmVkLFxyXG4gIH06IEFzc3VtZVJvbGVQcm92aWRlck9wdGlvbnMpIHtcclxuICAgIHN1cGVyKHsgYWNjZXNzS2V5LCBzZWNyZXRLZXksIHNlc3Npb25Ub2tlbiB9KVxyXG5cclxuICAgIHRoaXMuc3RzRW5kcG9pbnQgPSBuZXcgVVJMKHN0c0VuZHBvaW50KVxyXG4gICAgdGhpcy5hY2Nlc3NLZXkgPSBhY2Nlc3NLZXlcclxuICAgIHRoaXMuc2VjcmV0S2V5ID0gc2VjcmV0S2V5XHJcbiAgICB0aGlzLnBvbGljeSA9IHBvbGljeVxyXG4gICAgdGhpcy5yZWdpb24gPSByZWdpb25cclxuICAgIHRoaXMucm9sZUFybiA9IHJvbGVBcm5cclxuICAgIHRoaXMucm9sZVNlc3Npb25OYW1lID0gcm9sZVNlc3Npb25OYW1lXHJcbiAgICB0aGlzLmV4dGVybmFsSWQgPSBleHRlcm5hbElkXHJcbiAgICB0aGlzLnRva2VuID0gdG9rZW5cclxuICAgIHRoaXMud2ViSWRlbnRpdHlUb2tlbiA9IHdlYklkZW50aXR5VG9rZW5cclxuICAgIHRoaXMuYWN0aW9uID0gYWN0aW9uXHJcblxyXG4gICAgdGhpcy5kdXJhdGlvblNlY29uZHMgPSBwYXJzZUludChkdXJhdGlvblNlY29uZHMgYXMgdW5rbm93biBhcyBzdHJpbmcpXHJcblxyXG4gICAgbGV0IGV4cGlyeVNlY29uZHMgPSB0aGlzLmR1cmF0aW9uU2Vjb25kc1xyXG4gICAgaWYgKHRoaXMuZHVyYXRpb25TZWNvbmRzIDwgZGVmYXVsdEV4cGlyeVNlY29uZHMpIHtcclxuICAgICAgZXhwaXJ5U2Vjb25kcyA9IGRlZmF1bHRFeHBpcnlTZWNvbmRzXHJcbiAgICB9XHJcbiAgICB0aGlzLmV4cGlyeVNlY29uZHMgPSBleHBpcnlTZWNvbmRzIC8vIGZvciBjYWxjdWxhdGluZyByZWZyZXNoIG9mIGNyZWRlbnRpYWxzLlxyXG5cclxuICAgIC8vIEJ5IGRlZmF1bHQsIG5vZGVqcyB1c2VzIGEgZ2xvYmFsIGFnZW50IGlmIHRoZSAnYWdlbnQnIHByb3BlcnR5XHJcbiAgICAvLyBpcyBzZXQgdG8gdW5kZWZpbmVkLiBPdGhlcndpc2UsIGl0J3Mgb2theSB0byBhc3N1bWUgdGhlIHVzZXJzXHJcbiAgICAvLyBrbm93IHdoYXQgdGhleSdyZSBkb2luZyBpZiB0aGV5IHNwZWNpZnkgYSBjdXN0b20gdHJhbnNwb3J0IGFnZW50LlxyXG4gICAgdGhpcy50cmFuc3BvcnRBZ2VudCA9IHRyYW5zcG9ydEFnZW50XHJcbiAgICBjb25zdCBpc0h0dHA6IGJvb2xlYW4gPSB0aGlzLnN0c0VuZHBvaW50LnByb3RvY29sID09PSAnaHR0cDonXHJcbiAgICB0aGlzLnRyYW5zcG9ydCA9IGlzSHR0cCA/IGh0dHAgOiBodHRwc1xyXG5cclxuICAgIC8qKlxyXG4gICAgICogSW50ZXJuYWwgVHJhY2tpbmcgdmFyaWFibGVzXHJcbiAgICAgKi9cclxuICAgIHRoaXMuX2NyZWRlbnRpYWxzID0gbnVsbFxyXG4gIH1cclxuXHJcbiAgZ2V0UmVxdWVzdENvbmZpZygpOiB7XHJcbiAgICByZXF1ZXN0T3B0aW9uczogaHR0cC5SZXF1ZXN0T3B0aW9uc1xyXG4gICAgcmVxdWVzdERhdGE6IHN0cmluZ1xyXG4gIH0ge1xyXG4gICAgY29uc3QgaG9zdFZhbHVlID0gdGhpcy5zdHNFbmRwb2ludC5ob3N0bmFtZVxyXG4gICAgY29uc3QgcG9ydFZhbHVlID0gdGhpcy5zdHNFbmRwb2ludC5wb3J0XHJcbiAgICBjb25zdCBxcnlQYXJhbXMgPSBuZXcgVVJMU2VhcmNoUGFyYW1zKHsgQWN0aW9uOiB0aGlzLmFjdGlvbiwgVmVyc2lvbjogJzIwMTEtMDYtMTUnIH0pXHJcblxyXG4gICAgcXJ5UGFyYW1zLnNldCgnRHVyYXRpb25TZWNvbmRzJywgdGhpcy5leHBpcnlTZWNvbmRzLnRvU3RyaW5nKCkpXHJcblxyXG4gICAgaWYgKHRoaXMucG9saWN5KSB7XHJcbiAgICAgIHFyeVBhcmFtcy5zZXQoJ1BvbGljeScsIHRoaXMucG9saWN5KVxyXG4gICAgfVxyXG4gICAgaWYgKHRoaXMucm9sZUFybikge1xyXG4gICAgICBxcnlQYXJhbXMuc2V0KCdSb2xlQXJuJywgdGhpcy5yb2xlQXJuKVxyXG4gICAgfVxyXG5cclxuICAgIGlmICh0aGlzLnJvbGVTZXNzaW9uTmFtZSAhPSBudWxsKSB7XHJcbiAgICAgIHFyeVBhcmFtcy5zZXQoJ1JvbGVTZXNzaW9uTmFtZScsIHRoaXMucm9sZVNlc3Npb25OYW1lKVxyXG4gICAgfVxyXG4gICAgaWYgKHRoaXMudG9rZW4gIT0gbnVsbCkge1xyXG4gICAgICBxcnlQYXJhbXMuc2V0KCdUb2tlbicsIHRoaXMudG9rZW4pXHJcbiAgICB9XHJcblxyXG4gICAgaWYgKHRoaXMud2ViSWRlbnRpdHlUb2tlbikge1xyXG4gICAgICBxcnlQYXJhbXMuc2V0KCdXZWJJZGVudGl0eVRva2VuJywgdGhpcy53ZWJJZGVudGl0eVRva2VuKVxyXG4gICAgfVxyXG5cclxuICAgIGlmICh0aGlzLmV4dGVybmFsSWQpIHtcclxuICAgICAgcXJ5UGFyYW1zLnNldCgnRXh0ZXJuYWxJZCcsIHRoaXMuZXh0ZXJuYWxJZClcclxuICAgIH1cclxuXHJcbiAgICBjb25zdCB1cmxQYXJhbXMgPSBxcnlQYXJhbXMudG9TdHJpbmcoKVxyXG4gICAgY29uc3QgY29udGVudFNoYTI1NiA9IHRvU2hhMjU2KHVybFBhcmFtcylcclxuXHJcbiAgICBjb25zdCBkYXRlID0gbmV3IERhdGUoKVxyXG5cclxuICAgIGNvbnN0IHJlcXVlc3RPcHRpb25zID0ge1xyXG4gICAgICBob3N0bmFtZTogaG9zdFZhbHVlLFxyXG4gICAgICBwb3J0OiBwb3J0VmFsdWUsXHJcbiAgICAgIHBhdGg6ICcvJyxcclxuICAgICAgcHJvdG9jb2w6IHRoaXMuc3RzRW5kcG9pbnQucHJvdG9jb2wsXHJcbiAgICAgIG1ldGhvZDogJ1BPU1QnLFxyXG4gICAgICBoZWFkZXJzOiB7XHJcbiAgICAgICAgJ0NvbnRlbnQtVHlwZSc6ICdhcHBsaWNhdGlvbi94LXd3dy1mb3JtLXVybGVuY29kZWQnLFxyXG4gICAgICAgICdjb250ZW50LWxlbmd0aCc6IHVybFBhcmFtcy5sZW5ndGgudG9TdHJpbmcoKSxcclxuICAgICAgICBob3N0OiBob3N0VmFsdWUsXHJcbiAgICAgICAgJ3gtYW16LWRhdGUnOiBtYWtlRGF0ZUxvbmcoZGF0ZSksXHJcbiAgICAgICAgJ3gtYW16LWNvbnRlbnQtc2hhMjU2JzogY29udGVudFNoYTI1NixcclxuICAgICAgfSBhcyBSZWNvcmQ8c3RyaW5nLCBzdHJpbmc+LFxyXG4gICAgICBhZ2VudDogdGhpcy50cmFuc3BvcnRBZ2VudCxcclxuICAgIH0gc2F0aXNmaWVzIGh0dHAuUmVxdWVzdE9wdGlvbnNcclxuXHJcbiAgICByZXF1ZXN0T3B0aW9ucy5oZWFkZXJzLmF1dGhvcml6YXRpb24gPSBzaWduVjRCeVNlcnZpY2VOYW1lKFxyXG4gICAgICByZXF1ZXN0T3B0aW9ucyxcclxuICAgICAgdGhpcy5hY2Nlc3NLZXksXHJcbiAgICAgIHRoaXMuc2VjcmV0S2V5LFxyXG4gICAgICB0aGlzLnJlZ2lvbixcclxuICAgICAgZGF0ZSxcclxuICAgICAgY29udGVudFNoYTI1NixcclxuICAgICAgJ3N0cycsXHJcbiAgICApXHJcblxyXG4gICAgcmV0dXJuIHtcclxuICAgICAgcmVxdWVzdE9wdGlvbnMsXHJcbiAgICAgIHJlcXVlc3REYXRhOiB1cmxQYXJhbXMsXHJcbiAgICB9XHJcbiAgfVxyXG5cclxuICBhc3luYyBwZXJmb3JtUmVxdWVzdCgpOiBQcm9taXNlPENyZWRlbnRpYWxSZXNwb25zZT4ge1xyXG4gICAgY29uc3QgeyByZXF1ZXN0T3B0aW9ucywgcmVxdWVzdERhdGEgfSA9IHRoaXMuZ2V0UmVxdWVzdENvbmZpZygpXHJcblxyXG4gICAgY29uc3QgcmVzID0gYXdhaXQgcmVxdWVzdCh0aGlzLnRyYW5zcG9ydCwgcmVxdWVzdE9wdGlvbnMsIHJlcXVlc3REYXRhKVxyXG5cclxuICAgIGNvbnN0IGJvZHkgPSBhd2FpdCByZWFkQXNTdHJpbmcocmVzKVxyXG5cclxuICAgIHJldHVybiBwYXJzZVhtbChib2R5KVxyXG4gIH1cclxuXHJcbiAgcGFyc2VDcmVkZW50aWFscyhyZXNwT2JqOiBDcmVkZW50aWFsUmVzcG9uc2UpOiBDcmVkZW50aWFscyB7XHJcbiAgICBpZiAocmVzcE9iai5FcnJvclJlc3BvbnNlKSB7XHJcbiAgICAgIHRocm93IG5ldyBFcnJvcihcclxuICAgICAgICBgVW5hYmxlIHRvIG9idGFpbiBjcmVkZW50aWFsczogJHtyZXNwT2JqLkVycm9yUmVzcG9uc2U/LkVycm9yPy5Db2RlfSAke3Jlc3BPYmouRXJyb3JSZXNwb25zZT8uRXJyb3I/Lk1lc3NhZ2V9YCxcclxuICAgICAgICB7IGNhdXNlOiByZXNwT2JqIH0sXHJcbiAgICAgIClcclxuICAgIH1cclxuXHJcbiAgICBjb25zdCB7XHJcbiAgICAgIEFzc3VtZVJvbGVSZXNwb25zZToge1xyXG4gICAgICAgIEFzc3VtZVJvbGVSZXN1bHQ6IHtcclxuICAgICAgICAgIENyZWRlbnRpYWxzOiB7XHJcbiAgICAgICAgICAgIEFjY2Vzc0tleUlkOiBhY2Nlc3NLZXksXHJcbiAgICAgICAgICAgIFNlY3JldEFjY2Vzc0tleTogc2VjcmV0S2V5LFxyXG4gICAgICAgICAgICBTZXNzaW9uVG9rZW46IHNlc3Npb25Ub2tlbixcclxuICAgICAgICAgICAgRXhwaXJhdGlvbjogZXhwaXJlc0F0LFxyXG4gICAgICAgICAgfSxcclxuICAgICAgICB9LFxyXG4gICAgICB9LFxyXG4gICAgfSA9IHJlc3BPYmpcclxuXHJcbiAgICB0aGlzLmFjY2Vzc0V4cGlyZXNBdCA9IGV4cGlyZXNBdFxyXG5cclxuICAgIHJldHVybiBuZXcgQ3JlZGVudGlhbHMoeyBhY2Nlc3NLZXksIHNlY3JldEtleSwgc2Vzc2lvblRva2VuIH0pXHJcbiAgfVxyXG5cclxuICBhc3luYyByZWZyZXNoQ3JlZGVudGlhbHMoKTogUHJvbWlzZTxDcmVkZW50aWFscz4ge1xyXG4gICAgdHJ5IHtcclxuICAgICAgY29uc3QgYXNzdW1lUm9sZUNyZWRlbnRpYWxzID0gYXdhaXQgdGhpcy5wZXJmb3JtUmVxdWVzdCgpXHJcbiAgICAgIHRoaXMuX2NyZWRlbnRpYWxzID0gdGhpcy5wYXJzZUNyZWRlbnRpYWxzKGFzc3VtZVJvbGVDcmVkZW50aWFscylcclxuICAgIH0gY2F0Y2ggKGVycikge1xyXG4gICAgICB0aHJvdyBuZXcgRXJyb3IoYEZhaWxlZCB0byBnZXQgQ3JlZGVudGlhbHM6ICR7ZXJyfWAsIHsgY2F1c2U6IGVyciB9KVxyXG4gICAgfVxyXG5cclxuICAgIHJldHVybiB0aGlzLl9jcmVkZW50aWFsc1xyXG4gIH1cclxuXHJcbiAgYXN5bmMgZ2V0Q3JlZGVudGlhbHMoKTogUHJvbWlzZTxDcmVkZW50aWFscz4ge1xyXG4gICAgaWYgKHRoaXMuX2NyZWRlbnRpYWxzICYmICF0aGlzLmlzQWJvdXRUb0V4cGlyZSgpKSB7XHJcbiAgICAgIHJldHVybiB0aGlzLl9jcmVkZW50aWFsc1xyXG4gICAgfVxyXG5cclxuICAgIHRoaXMuX2NyZWRlbnRpYWxzID0gYXdhaXQgdGhpcy5yZWZyZXNoQ3JlZGVudGlhbHMoKVxyXG4gICAgcmV0dXJuIHRoaXMuX2NyZWRlbnRpYWxzXHJcbiAgfVxyXG5cclxuICBpc0Fib3V0VG9FeHBpcmUoKSB7XHJcbiAgICBjb25zdCBleHBpcmVzQXQgPSBuZXcgRGF0ZSh0aGlzLmFjY2Vzc0V4cGlyZXNBdClcclxuICAgIGNvbnN0IHByb3Zpc2lvbmFsRXhwaXJ5ID0gbmV3IERhdGUoRGF0ZS5ub3coKSArIDEwMDAgKiAxMCkgLy8gY2hlY2sgYmVmb3JlIDEwIHNlY29uZHMuXHJcbiAgICByZXR1cm4gcHJvdmlzaW9uYWxFeHBpcnkgPiBleHBpcmVzQXRcclxuICB9XHJcbn1cclxuXHJcbi8vIGRlcHJlY2F0ZWQgZGVmYXVsdCBleHBvcnQsIHBsZWFzZSB1c2UgbmFtZWQgZXhwb3J0cy5cclxuLy8ga2VlcCBmb3IgYmFja3dhcmQgY29tcGF0aWJpbGl0eS5cclxuLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIGltcG9ydC9uby1kZWZhdWx0LWV4cG9ydFxyXG5leHBvcnQgZGVmYXVsdCBBc3N1bWVSb2xlUHJvdmlkZXJcclxuIl0sIm1hcHBpbmdzIjoiQUFBQSxPQUFPLEtBQUtBLElBQUk7QUFDaEIsT0FBTyxLQUFLQyxLQUFLO0FBQ2pCLFNBQVNDLEdBQUcsRUFBRUMsZUFBZTtBQUU3QixTQUFTQyxrQkFBa0IsUUFBUSwwQkFBeUI7QUFDNUQsU0FBU0MsV0FBVyxRQUFRLG1CQUFrQjtBQUM5QyxTQUFTQyxZQUFZLEVBQUVDLFFBQVEsRUFBRUMsUUFBUSxRQUFRLHVCQUFzQjtBQUN2RSxTQUFTQyxPQUFPLFFBQVEsd0JBQXVCO0FBQy9DLFNBQVNDLFlBQVksUUFBUSx5QkFBd0I7QUFFckQsU0FBU0MsbUJBQW1CLFFBQVEsZUFBYzs7QUFFbEQ7QUFDQTtBQUNBOztBQXNDQSxNQUFNQyxvQkFBb0IsR0FBRyxHQUFHO0FBRWhDLE9BQU8sTUFBTUMsa0JBQWtCLFNBQVNULGtCQUFrQixDQUFDO0VBZ0JqRFUsZUFBZSxHQUFHLEVBQUU7RUFLNUJDLFdBQVdBLENBQUM7SUFDVkMsV0FBVztJQUNYQyxTQUFTO0lBQ1RDLFNBQVM7SUFDVEMsZUFBZSxHQUFHUCxvQkFBb0I7SUFDdENRLFlBQVk7SUFDWkMsTUFBTTtJQUNOQyxNQUFNLEdBQUcsRUFBRTtJQUNYQyxPQUFPO0lBQ1BDLGVBQWU7SUFDZkMsVUFBVTtJQUNWQyxLQUFLO0lBQ0xDLGdCQUFnQjtJQUNoQkMsTUFBTSxHQUFHLFlBQVk7SUFDckJDLGNBQWMsR0FBR0M7RUFDUSxDQUFDLEVBQUU7SUFDNUIsS0FBSyxDQUFDO01BQUViLFNBQVM7TUFBRUMsU0FBUztNQUFFRTtJQUFhLENBQUMsQ0FBQztJQUU3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