"use strict";

Object.defineProperty(exports, "__esModule", {
  value: true
});
var _eventemitter = require("eventemitter3");
var _Parser = require("stream-json/jsonl/Parser.js");
var _helpers = require("./helpers.js");
var _helper = require("./internal/helper.js");
/*
 * MinIO Javascript Library for Amazon S3 Compatible Cloud Storage, (C) 2016 MinIO, Inc.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */

// TODO: type this

// Base class for three supported configs.
class TargetConfig {
  setId(id) {
    this.Id = id;
  }
  addEvent(newevent) {
    if (!this.Event) {
      this.Event = [];
    }
    this.Event.push(newevent);
  }
  addFilterSuffix(suffix) {
    if (!this.Filter) {
      this.Filter = {
        S3Key: {
          FilterRule: []
        }
      };
    }
    this.Filter.S3Key.FilterRule.push({
      Name: 'suffix',
      Value: suffix
    });
  }
  addFilterPrefix(prefix) {
    if (!this.Filter) {
      this.Filter = {
        S3Key: {
          FilterRule: []
        }
      };
    }
    this.Filter.S3Key.FilterRule.push({
      Name: 'prefix',
      Value: prefix
    });
  }
}

// 1. Topic (simple notification service)
exports.TargetConfig = TargetConfig;
class TopicConfig extends TargetConfig {
  constructor(arn) {
    super();
    this.Topic = arn;
  }
}

// 2. Queue (simple queue service)
exports.TopicConfig = TopicConfig;
class QueueConfig extends TargetConfig {
  constructor(arn) {
    super();
    this.Queue = arn;
  }
}

// 3. CloudFront (lambda function)
exports.QueueConfig = QueueConfig;
class CloudFunctionConfig extends TargetConfig {
  constructor(arn) {
    super();
    this.CloudFunction = arn;
  }
}

// Notification config - array of target configs.
// Target configs can be
// 1. Topic (simple notification service)
// 2. Queue (simple queue service)
// 3. CloudFront (lambda function)
exports.CloudFunctionConfig = CloudFunctionConfig;
class NotificationConfig {
  add(target) {
    let instance;
    if (target instanceof TopicConfig) {
      instance = this.TopicConfiguration ?? (this.TopicConfiguration = []);
    }
    if (target instanceof QueueConfig) {
      instance = this.QueueConfiguration ?? (this.QueueConfiguration = []);
    }
    if (target instanceof CloudFunctionConfig) {
      instance = this.CloudFunctionConfiguration ?? (this.CloudFunctionConfiguration = []);
    }
    if (instance) {
      instance.push(target);
    }
  }
}
exports.NotificationConfig = NotificationConfig;
const buildARN = (partition, service, region, accountId, resource) => {
  return 'arn:' + partition + ':' + service + ':' + region + ':' + accountId + ':' + resource;
};
exports.buildARN = buildARN;
const ObjectCreatedAll = exports.ObjectCreatedAll = 's3:ObjectCreated:*';
const ObjectCreatedPut = exports.ObjectCreatedPut = 's3:ObjectCreated:Put';
const ObjectCreatedPost = exports.ObjectCreatedPost = 's3:ObjectCreated:Post';
const ObjectCreatedCopy = exports.ObjectCreatedCopy = 's3:ObjectCreated:Copy';
const ObjectCreatedCompleteMultipartUpload = exports.ObjectCreatedCompleteMultipartUpload = 's3:ObjectCreated:CompleteMultipartUpload';
const ObjectRemovedAll = exports.ObjectRemovedAll = 's3:ObjectRemoved:*';
const ObjectRemovedDelete = exports.ObjectRemovedDelete = 's3:ObjectRemoved:Delete';
const ObjectRemovedDeleteMarkerCreated = exports.ObjectRemovedDeleteMarkerCreated = 's3:ObjectRemoved:DeleteMarkerCreated';
const ObjectReducedRedundancyLostObject = exports.ObjectReducedRedundancyLostObject = 's3:ReducedRedundancyLostObject';

// put string at least so auto-complete could work

// TODO: type this

// Poll for notifications, used in #listenBucketNotification.
// Listening constitutes repeatedly requesting s3 whether or not any
// changes have occurred.
class NotificationPoller extends _eventemitter.EventEmitter {
  constructor(client, bucketName, prefix, suffix, events) {
    super();
    this.client = client;
    this.bucketName = bucketName;
    this.prefix = prefix;
    this.suffix = suffix;
    this.events = events;
    this.ending = false;
  }

  // Starts the polling.
  start() {
    this.ending = false;
    process.nextTick(() => {
      this.checkForChanges();
    });
  }

  // Stops the polling.
  stop() {
    this.ending = true;
  }
  checkForChanges() {
    // Don't continue if we're looping again but are cancelled.
    if (this.ending) {
      return;
    }
    const method = 'GET';
    const queries = [];
    if (this.prefix) {
      const prefix = (0, _helper.uriEscape)(this.prefix);
      queries.push(`prefix=${prefix}`);
    }
    if (this.suffix) {
      const suffix = (0, _helper.uriEscape)(this.suffix);
      queries.push(`suffix=${suffix}`);
    }
    if (this.events) {
      this.events.forEach(s3event => queries.push('events=' + (0, _helper.uriEscape)(s3event)));
    }
    queries.sort();
    let query = '';
    if (queries.length > 0) {
      query = `${queries.join('&')}`;
    }
    const region = this.client.region || _helpers.DEFAULT_REGION;
    this.client.makeRequestAsync({
      method,
      bucketName: this.bucketName,
      query
    }, '', [200], region).then(response => {
      const asm = _Parser.make();
      (0, _helper.pipesetup)(response, asm).on('data', data => {
        // Data is flushed periodically (every 5 seconds), so we should
        // handle it after flushing from the JSON parser.
        let records = data.value.Records;
        // If null (= no records), change to an empty array.
        if (!records) {
          records = [];
        }

        // Iterate over the notifications and emit them individually.
        records.forEach(record => {
          this.emit('notification', record);
        });

        // If we're done, stop.
        if (this.ending) {
          response === null || response === void 0 || response.destroy();
        }
      }).on('error', e => this.emit('error', e)).on('end', () => {
        // Do it again, if we haven't cancelled yet.
        process.nextTick(() => {
          this.checkForChanges();
        });
      });
    }, e => {
      return this.emit('error', e);
    });
  }
}
exports.NotificationPoller = NotificationPoller;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJfZXZlbnRlbWl0dGVyIiwicmVxdWlyZSIsIl9QYXJzZXIiLCJfaGVscGVycyIsIl9oZWxwZXIiLCJUYXJnZXRDb25maWciLCJzZXRJZCIsImlkIiwiSWQiLCJhZGRFdmVudCIsIm5ld2V2ZW50IiwiRXZlbnQiLCJwdXNoIiwiYWRkRmlsdGVyU3VmZml4Iiwic3VmZml4IiwiRmlsdGVyIiwiUzNLZXkiLCJGaWx0ZXJSdWxlIiwiTmFtZSIsIlZhbHVlIiwiYWRkRmlsdGVyUHJlZml4IiwicHJlZml4IiwiZXhwb3J0cyIsIlRvcGljQ29uZmlnIiwiY29uc3RydWN0b3IiLCJhcm4iLCJUb3BpYyIsIlF1ZXVlQ29uZmlnIiwiUXVldWUiLCJDbG91ZEZ1bmN0aW9uQ29uZmlnIiwiQ2xvdWRGdW5jdGlvbiIsIk5vdGlmaWNhdGlvbkNvbmZpZyIsImFkZCIsInRhcmdldCIsImluc3RhbmNlIiwiVG9waWNDb25maWd1cmF0aW9uIiwiUXVldWVDb25maWd1cmF0aW9uIiwiQ2xvdWRGdW5jdGlvbkNvbmZpZ3VyYXRpb24iLCJidWlsZEFSTiIsInBhcnRpdGlvbiIsInNlcnZpY2UiLCJyZWdpb24iLCJhY2NvdW50SWQiLCJyZXNvdXJjZSIsIk9iamVjdENyZWF0ZWRBbGwiLCJPYmplY3RDcmVhdGVkUHV0IiwiT2JqZWN0Q3JlYXRlZFBvc3QiLCJPYmplY3RDcmVhdGVkQ29weSIsIk9iamVjdENyZWF0ZWRDb21wbGV0ZU11bHRpcGFydFVwbG9hZCIsIk9iamVjdFJlbW92ZWRBbGwiLCJPYmplY3RSZW1vdmVkRGVsZXRlIiwiT2JqZWN0UmVtb3ZlZERlbGV0ZU1hcmtlckNyZWF0ZWQiLCJPYmplY3RSZWR1Y2VkUmVkdW5kYW5jeUxvc3RPYmplY3QiLCJOb3RpZmljYXRpb25Qb2xsZXIiLCJFdmVudEVtaXR0ZXIiLCJjbGllbnQiLCJidWNrZXROYW1lIiwiZXZlbnRzIiwiZW5kaW5nIiwic3RhcnQiLCJwcm9jZXNzIiwibmV4dFRpY2siLCJjaGVja0ZvckNoYW5nZXMiLCJzdG9wIiwibWV0aG9kIiwicXVlcmllcyIsInVyaUVzY2FwZSIsImZvckVhY2giLCJzM2V2ZW50Iiwic29ydCIsInF1ZXJ5IiwibGVuZ3RoIiwiam9pbiIsIkRFRkFVTFRfUkVHSU9OIiwibWFrZVJlcXVlc3RBc3luYyIsInRoZW4iLCJyZXNwb25zZSIsImFzbSIsImpzb25MaW5lUGFyc2VyIiwibWFrZSIsInBpcGVzZXR1cCIsIm9uIiwiZGF0YSIsInJlY29yZHMiLCJ2YWx1ZSIsIlJlY29yZHMiLCJyZWNvcmQiLCJlbWl0IiwiZGVzdHJveSIsImUiXSwic291cmNlcyI6WyJub3RpZmljYXRpb24udHMiXSwic291cmNlc0NvbnRlbnQiOlsiLypcclxuICogTWluSU8gSmF2YXNjcmlwdCBMaWJyYXJ5IGZvciBBbWF6b24gUzMgQ29tcGF0aWJsZSBDbG91ZCBTdG9yYWdlLCAoQykgMjAxNiBNaW5JTywgSW5jLlxyXG4gKlxyXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xyXG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXHJcbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxyXG4gKlxyXG4gKiAgICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXHJcbiAqXHJcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcclxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxyXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cclxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxyXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cclxuICovXHJcblxyXG5pbXBvcnQgeyBFdmVudEVtaXR0ZXIgfSBmcm9tICdldmVudGVtaXR0ZXIzJ1xyXG5pbXBvcnQganNvbkxpbmVQYXJzZXIgZnJvbSAnc3RyZWFtLWpzb24vanNvbmwvUGFyc2VyLmpzJ1xyXG5cclxuaW1wb3J0IHsgREVGQVVMVF9SRUdJT04gfSBmcm9tICcuL2hlbHBlcnMudHMnXHJcbmltcG9ydCB0eXBlIHsgVHlwZWRDbGllbnQgfSBmcm9tICcuL2ludGVybmFsL2NsaWVudC50cydcclxuaW1wb3J0IHsgcGlwZXNldHVwLCB1cmlFc2NhcGUgfSBmcm9tICcuL2ludGVybmFsL2hlbHBlci50cydcclxuXHJcbi8vIFRPRE86IHR5cGUgdGhpc1xyXG5cclxudHlwZSBFdmVudCA9IHVua25vd25cclxuXHJcbi8vIEJhc2UgY2xhc3MgZm9yIHRocmVlIHN1cHBvcnRlZCBjb25maWdzLlxyXG5leHBvcnQgY2xhc3MgVGFyZ2V0Q29uZmlnIHtcclxuICBwcml2YXRlIEZpbHRlcj86IHsgUzNLZXk6IHsgRmlsdGVyUnVsZTogeyBOYW1lOiBzdHJpbmc7IFZhbHVlOiBzdHJpbmcgfVtdIH0gfVxyXG4gIHByaXZhdGUgRXZlbnQ/OiBFdmVudFtdXHJcbiAgcHJpdmF0ZSBJZDogdW5rbm93blxyXG5cclxuICBzZXRJZChpZDogdW5rbm93bikge1xyXG4gICAgdGhpcy5JZCA9IGlkXHJcbiAgfVxyXG5cclxuICBhZGRFdmVudChuZXdldmVudDogRXZlbnQpIHtcclxuICAgIGlmICghdGhpcy5FdmVudCkge1xyXG4gICAgICB0aGlzLkV2ZW50ID0gW11cclxuICAgIH1cclxuICAgIHRoaXMuRXZlbnQucHVzaChuZXdldmVudClcclxuICB9XHJcblxyXG4gIGFkZEZpbHRlclN1ZmZpeChzdWZmaXg6IHN0cmluZykge1xyXG4gICAgaWYgKCF0aGlzLkZpbHRlcikge1xyXG4gICAgICB0aGlzLkZpbHRlciA9IHsgUzNLZXk6IHsgRmlsdGVyUnVsZTogW10gfSB9XHJcbiAgICB9XHJcbiAgICB0aGlzLkZpbHRlci5TM0tleS5GaWx0ZXJSdWxlLnB1c2goeyBOYW1lOiAnc3VmZml4JywgVmFsdWU6IHN1ZmZpeCB9KVxyXG4gIH1cclxuXHJcbiAgYWRkRmlsdGVyUHJlZml4KHByZWZpeDogc3RyaW5nKSB7XHJcbiAgICBpZiAoIXRoaXMuRmlsdGVyKSB7XHJcbiAgICAgIHRoaXMuRmlsdGVyID0geyBTM0tleTogeyBGaWx0ZXJSdWxlOiBbXSB9IH1cclxuICAgIH1cclxuICAgIHRoaXMuRmlsdGVyLlMzS2V5LkZpbHRlclJ1bGUucHVzaCh7IE5hbWU6ICdwcmVmaXgnLCBWYWx1ZTogcHJlZml4IH0pXHJcbiAgfVxyXG59XHJcblxyXG4vLyAxLiBUb3BpYyAoc2ltcGxlIG5vdGlmaWNhdGlvbiBzZXJ2aWNlKVxyXG5leHBvcnQgY2xhc3MgVG9waWNDb25maWcgZXh0ZW5kcyBUYXJnZXRDb25maWcge1xyXG4gIHByaXZhdGUgVG9waWM6IHN0cmluZ1xyXG5cclxuICBjb25zdHJ1Y3Rvcihhcm46IHN0cmluZykge1xyXG4gICAgc3VwZXIoKVxyXG4gICAgdGhpcy5Ub3BpYyA9IGFyblxyXG4gIH1cclxufVxyXG5cclxuLy8gMi4gUXVldWUgKHNpbXBsZSBxdWV1ZSBzZXJ2aWNlKVxyXG5leHBvcnQgY2xhc3MgUXVldWVDb25maWcgZXh0ZW5kcyBUYXJnZXRDb25maWcge1xyXG4gIHByaXZhdGUgUXVldWU6IHN0cmluZ1xyXG5cclxuICBjb25zdHJ1Y3Rvcihhcm46IHN0cmluZykge1xyXG4gICAgc3VwZXIoKVxyXG4gICAgdGhpcy5RdWV1ZSA9IGFyblxyXG4gIH1cclxufVxyXG5cclxuLy8gMy4gQ2xvdWRGcm9udCAobGFtYmRhIGZ1bmN0aW9uKVxyXG5leHBvcnQgY2xhc3MgQ2xvdWRGdW5jdGlvbkNvbmZpZyBleHRlbmRzIFRhcmdldENvbmZpZyB7XHJcbiAgcHJpdmF0ZSBDbG91ZEZ1bmN0aW9uOiBzdHJpbmdcclxuXHJcbiAgY29uc3RydWN0b3IoYXJuOiBzdHJpbmcpIHtcclxuICAgIHN1cGVyKClcclxuICAgIHRoaXMuQ2xvdWRGdW5jdGlvbiA9IGFyblxyXG4gIH1cclxufVxyXG5cclxuLy8gTm90aWZpY2F0aW9uIGNvbmZpZyAtIGFycmF5IG9mIHRhcmdldCBjb25maWdzLlxyXG4vLyBUYXJnZXQgY29uZmlncyBjYW4gYmVcclxuLy8gMS4gVG9waWMgKHNpbXBsZSBub3RpZmljYXRpb24gc2VydmljZSlcclxuLy8gMi4gUXVldWUgKHNpbXBsZSBxdWV1ZSBzZXJ2aWNlKVxyXG4vLyAzLiBDbG91ZEZyb250IChsYW1iZGEgZnVuY3Rpb24pXHJcbmV4cG9ydCBjbGFzcyBOb3RpZmljYXRpb25Db25maWcge1xyXG4gIHByaXZhdGUgVG9waWNDb25maWd1cmF0aW9uPzogVGFyZ2V0Q29uZmlnW11cclxuICBwcml2YXRlIENsb3VkRnVuY3Rpb25Db25maWd1cmF0aW9uPzogVGFyZ2V0Q29uZmlnW11cclxuICBwcml2YXRlIFF1ZXVlQ29uZmlndXJhdGlvbj86IFRhcmdldENvbmZpZ1tdXHJcblxyXG4gIGFkZCh0YXJnZXQ6IFRhcmdldENvbmZpZykge1xyXG4gICAgbGV0IGluc3RhbmNlOiBUYXJnZXRDb25maWdbXSB8IHVuZGVmaW5lZFxyXG4gICAgaWYgKHRhcmdldCBpbnN0YW5jZW9mIFRvcGljQ29uZmlnKSB7XHJcbiAgICAgIGluc3RhbmNlID0gdGhpcy5Ub3BpY0NvbmZpZ3VyYXRpb24gPz89IFtdXHJcbiAgICB9XHJcbiAgICBpZiAodGFyZ2V0IGluc3RhbmNlb2YgUXVldWVDb25maWcpIHtcclxuICAgICAgaW5zdGFuY2UgPSB0aGlzLlF1ZXVlQ29uZmlndXJhdGlvbiA/Pz0gW11cclxuICAgIH1cclxuICAgIGlmICh0YXJnZXQgaW5zdGFuY2VvZiBDbG91ZEZ1bmN0aW9uQ29uZmlnKSB7XHJcbiAgICAgIGluc3RhbmNlID0gdGhpcy5DbG91ZEZ1bmN0aW9uQ29uZmlndXJhdGlvbiA/Pz0gW11cclxuICAgIH1cclxuICAgIGlmIChpbnN0YW5jZSkge1xyXG4gICAgICBpbnN0YW5jZS5wdXNoKHRhcmdldClcclxuICAgIH1cclxuICB9XHJcbn1cclxuXHJcbmV4cG9ydCBjb25zdCBidWlsZEFSTiA9IChwYXJ0aXRpb246IHN0cmluZywgc2VydmljZTogc3RyaW5nLCByZWdpb246IHN0cmluZywgYWNjb3VudElkOiBzdHJpbmcsIHJlc291cmNlOiBzdHJpbmcpID0+IHtcclxuICByZXR1cm4gJ2FybjonICsgcGFydGl0aW9uICsgJzonICsgc2VydmljZSArICc6JyArIHJlZ2lvbiArICc6JyArIGFjY291bnRJZCArICc6JyArIHJlc291cmNlXHJcbn1cclxuZXhwb3J0IGNvbnN0IE9iamVjdENyZWF0ZWRBbGwgPSAnczM6T2JqZWN0Q3JlYXRlZDoqJ1xyXG5leHBvcnQgY29uc3QgT2JqZWN0Q3JlYXRlZFB1dCA9ICdzMzpPYmplY3RDcmVhdGVkOlB1dCdcclxuZXhwb3J0IGNvbnN0IE9iamVjdENyZWF0ZWRQb3N0ID0gJ3MzOk9iamVjdENyZWF0ZWQ6UG9zdCdcclxuZXhwb3J0IGNvbnN0IE9iamVjdENyZWF0ZWRDb3B5ID0gJ3MzOk9iamVjdENyZWF0ZWQ6Q29weSdcclxuZXhwb3J0IGNvbnN0IE9iamVjdENyZWF0ZWRDb21wbGV0ZU11bHRpcGFydFVwbG9hZCA9ICdzMzpPYmplY3RDcmVhdGVkOkNvbXBsZXRlTXVsdGlwYXJ0VXBsb2FkJ1xyXG5leHBvcnQgY29uc3QgT2JqZWN0UmVtb3ZlZEFsbCA9ICdzMzpPYmplY3RSZW1vdmVkOionXHJcbmV4cG9ydCBjb25zdCBPYmplY3RSZW1vdmVkRGVsZXRlID0gJ3MzOk9iamVjdFJlbW92ZWQ6RGVsZXRlJ1xyXG5leHBvcnQgY29uc3QgT2JqZWN0UmVtb3ZlZERlbGV0ZU1hcmtlckNyZWF0ZWQgPSAnczM6T2JqZWN0UmVtb3ZlZDpEZWxldGVNYXJrZXJDcmVhdGVkJ1xyXG5leHBvcnQgY29uc3QgT2JqZWN0UmVkdWNlZFJlZHVuZGFuY3lMb3N0T2JqZWN0ID0gJ3MzOlJlZHVjZWRSZWR1bmRhbmN5TG9zdE9iamVjdCdcclxuZXhwb3J0IHR5cGUgTm90aWZpY2F0aW9uRXZlbnQgPVxyXG4gIHwgJ3MzOk9iamVjdENyZWF0ZWQ6KidcclxuICB8ICdzMzpPYmplY3RDcmVhdGVkOlB1dCdcclxuICB8ICdzMzpPYmplY3RDcmVhdGVkOlBvc3QnXHJcbiAgfCAnczM6T2JqZWN0Q3JlYXRlZDpDb3B5J1xyXG4gIHwgJ3MzOk9iamVjdENyZWF0ZWQ6Q29tcGxldGVNdWx0aXBhcnRVcGxvYWQnXHJcbiAgfCAnczM6T2JqZWN0UmVtb3ZlZDoqJ1xyXG4gIHwgJ3MzOk9iamVjdFJlbW92ZWQ6RGVsZXRlJ1xyXG4gIHwgJ3MzOk9iamVjdFJlbW92ZWQ6RGVsZXRlTWFya2VyQ3JlYXRlZCdcclxuICB8ICdzMzpSZWR1Y2VkUmVkdW5kYW5jeUxvc3RPYmplY3QnXHJcbiAgfCAnczM6VGVzdEV2ZW50J1xyXG4gIHwgJ3MzOk9iamVjdFJlc3RvcmU6UG9zdCdcclxuICB8ICdzMzpPYmplY3RSZXN0b3JlOkNvbXBsZXRlZCdcclxuICB8ICdzMzpSZXBsaWNhdGlvbjpPcGVyYXRpb25GYWlsZWRSZXBsaWNhdGlvbidcclxuICB8ICdzMzpSZXBsaWNhdGlvbjpPcGVyYXRpb25NaXNzZWRUaHJlc2hvbGQnXHJcbiAgfCAnczM6UmVwbGljYXRpb246T3BlcmF0aW9uUmVwbGljYXRlZEFmdGVyVGhyZXNob2xkJ1xyXG4gIHwgJ3MzOlJlcGxpY2F0aW9uOk9wZXJhdGlvbk5vdFRyYWNrZWQnXHJcbiAgfCBzdHJpbmcgLy8gcHV0IHN0cmluZyBhdCBsZWFzdCBzbyBhdXRvLWNvbXBsZXRlIGNvdWxkIHdvcmtcclxuXHJcbi8vIFRPRE86IHR5cGUgdGhpc1xyXG5leHBvcnQgdHlwZSBOb3RpZmljYXRpb25SZWNvcmQgPSB1bmtub3duXHJcbi8vIFBvbGwgZm9yIG5vdGlmaWNhdGlvbnMsIHVzZWQgaW4gI2xpc3RlbkJ1Y2tldE5vdGlmaWNhdGlvbi5cclxuLy8gTGlzdGVuaW5nIGNvbnN0aXR1dGVzIHJlcGVhdGVkbHkgcmVxdWVzdGluZyBzMyB3aGV0aGVyIG9yIG5vdCBhbnlcclxuLy8gY2hhbmdlcyBoYXZlIG9jY3VycmVkLlxyXG5leHBvcnQgY2xhc3MgTm90aWZpY2F0aW9uUG9sbGVyIGV4dGVuZHMgRXZlbnRFbWl0dGVyPHtcclxuICBub3RpZmljYXRpb246IChldmVudDogTm90aWZpY2F0aW9uUmVjb3JkKSA9PiB2b2lkXHJcbiAgZXJyb3I6IChlcnJvcjogdW5rbm93bikgPT4gdm9pZFxyXG59PiB7XHJcbiAgcHJpdmF0ZSBjbGllbnQ6IFR5cGVkQ2xpZW50XHJcbiAgcHJpdmF0ZSBidWNrZXROYW1lOiBzdHJpbmdcclxuICBwcml2YXRlIHByZWZpeDogc3RyaW5nXHJcbiAgcHJpdmF0ZSBzdWZmaXg6IHN0cmluZ1xyXG4gIHByaXZhdGUgZXZlbnRzOiBOb3RpZmljYXRpb25FdmVudFtdXHJcbiAgcHJpdmF0ZSBlbmRpbmc6IGJvb2xlYW5cclxuXHJcbiAgY29uc3RydWN0b3IoY2xpZW50OiBUeXBlZENsaWVudCwgYnVja2V0TmFtZTogc3RyaW5nLCBwcmVmaXg6IHN0cmluZywgc3VmZml4OiBzdHJpbmcsIGV2ZW50czogTm90aWZpY2F0aW9uRXZlbnRbXSkge1xyXG4gICAgc3VwZXIoKVxyXG5cclxuICAgIHRoaXMuY2xpZW50ID0gY2xpZW50XHJcbiAgICB0aGlzLmJ1Y2tldE5hbWUgPSBidWNrZXROYW1lXHJcbiAgICB0aGlzLnByZWZpeCA9IHByZWZpeFxyXG4gICAgdGhpcy5zdWZmaXggPSBzdWZmaXhcclxuICAgIHRoaXMuZXZlbnRzID0gZXZlbnRzXHJcblxyXG4gICAgdGhpcy5lbmRpbmcgPSBmYWxzZVxyXG4gIH1cclxuXHJcbiAgLy8gU3RhcnRzIHRoZSBwb2xsaW5nLlxyXG4gIHN0YXJ0KCkge1xyXG4gICAgdGhpcy5lbmRpbmcgPSBmYWxzZVxyXG5cclxuICAgIHByb2Nlc3MubmV4dFRpY2soKCkgPT4ge1xyXG4gICAgICB0aGlzLmNoZWNrRm9yQ2hhbmdlcygpXHJcbiAgICB9KVxyXG4gIH1cclxuXHJcbiAgLy8gU3RvcHMgdGhlIHBvbGxpbmcuXHJcbiAgc3RvcCgpIHtcclxuICAgIHRoaXMuZW5kaW5nID0gdHJ1ZVxyXG4gIH1cclxuXHJcbiAgY2hlY2tGb3JDaGFuZ2VzKCkge1xyXG4gICAgLy8gRG9uJ3QgY29udGludWUgaWYgd2UncmUgbG9vcGluZyBhZ2FpbiBidXQgYXJlIGNhbmNlbGxlZC5cclxuICAgIGlmICh0aGlzLmVuZGluZykge1xyXG4gICAgICByZXR1cm5cclxuICAgIH1cclxuXHJcbiAgICBjb25zdCBtZXRob2QgPSAnR0VUJ1xyXG4gICAgY29uc3QgcXVlcmllcyA9IFtdXHJcbiAgICBpZiAodGhpcy5wcmVmaXgpIHtcclxuICAgICAgY29uc3QgcHJlZml4ID0gdXJpRXNjYXBlKHRoaXMucHJlZml4KVxyXG4gICAgICBxdWVyaWVzLnB1c2goYHByZWZpeD0ke3ByZWZpeH1gKVxyXG4gICAgfVxyXG4gICAgaWYgKHRoaXMuc3VmZml4KSB7XHJcbiAgICAgIGNvbnN0IHN1ZmZpeCA9IHVyaUVzY2FwZSh0aGlzLnN1ZmZpeClcclxuICAgICAgcXVlcmllcy5wdXNoKGBzdWZmaXg9JHtzdWZmaXh9YClcclxuICAgIH1cclxuICAgIGlmICh0aGlzLmV2ZW50cykge1xyXG4gICAgICB0aGlzLmV2ZW50cy5mb3JFYWNoKChzM2V2ZW50KSA9PiBxdWVyaWVzLnB1c2goJ2V2ZW50cz0nICsgdXJpRXNjYXBlKHMzZXZlbnQpKSlcclxuICAgIH1cclxuICAgIHF1ZXJpZXMuc29ydCgpXHJcblxyXG4gICAgbGV0IHF1ZXJ5ID0gJydcclxuICAgIGlmIChxdWVyaWVzLmxlbmd0aCA+IDApIHtcclxuICAgICAgcXVlcnkgPSBgJHtxdWVyaWVzLmpvaW4oJyYnKX1gXHJcbiAgICB9XHJcbiAgICBjb25zdCByZWdpb24gPSB0aGlzLmNsaWVudC5yZWdpb24gfHwgREVGQVVMVF9SRUdJT05cclxuXHJcbiAgICB0aGlzLmNsaWVudC5tYWtlUmVxdWVzdEFzeW5jKHsgbWV0aG9kLCBidWNrZXROYW1lOiB0aGlzLmJ1Y2tldE5hbWUsIHF1ZXJ5IH0sICcnLCBbMjAwXSwgcmVnaW9uKS50aGVuKFxyXG4gICAgICAocmVzcG9uc2UpID0+IHtcclxuICAgICAgICBjb25zdCBhc20gPSBqc29uTGluZVBhcnNlci5tYWtlKClcclxuXHJcbiAgICAgICAgcGlwZXNldHVwKHJlc3BvbnNlLCBhc20pXHJcbiAgICAgICAgICAub24oJ2RhdGEnLCAoZGF0YSkgPT4ge1xyXG4gICAgICAgICAgICAvLyBEYXRhIGlzIGZsdXNoZWQgcGVyaW9kaWNhbGx5IChldmVyeSA1IHNlY29uZHMpLCBzbyB3ZSBzaG91bGRcclxuICAgICAgICAgICAgLy8gaGFuZGxlIGl0IGFmdGVyIGZsdXNoaW5nIGZyb20gdGhlIEpTT04gcGFyc2VyLlxyXG4gICAgICAgICAgICBsZXQgcmVjb3JkcyA9IGRhdGEudmFsdWUuUmVjb3Jkc1xyXG4gICAgICAgICAgICAvLyBJZiBudWxsICg9IG5vIHJlY29yZHMpLCBjaGFuZ2UgdG8gYW4gZW1wdHkgYXJyYXkuXHJcbiAgICAgICAgICAgIGlmICghcmVjb3Jkcykge1xyXG4gICAgICAgICAgICAgIHJlY29yZHMgPSBbXVxyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICAvLyBJdGVyYXRlIG92ZXIgdGhlIG5vdGlmaWNhdGlvbnMgYW5kIGVtaXQgdGhlbSBpbmRpdmlkdWFsbHkuXHJcbiAgICAgICAgICAgIHJlY29yZHMuZm9yRWFjaCgocmVjb3JkOiBOb3RpZmljYXRpb25SZWNvcmQpID0+IHtcclxuICAgICAgICAgICAgICB0aGlzLmVtaXQoJ25vdGlmaWNhdGlvbicsIHJlY29yZClcclxuICAgICAgICAgICAgfSlcclxuXHJcbiAgICAgICAgICAgIC8vIElmIHdlJ3JlIGRvbmUsIHN0b3AuXHJcbiAgICAgICAgICAgIGlmICh0aGlzLmVuZGluZykge1xyXG4gICAgICAgICAgICAgIHJlc3BvbnNlPy5kZXN0cm95KClcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgfSlcclxuICAgICAgICAgIC5vbignZXJyb3InLCAoZSkgPT4gdGhpcy5lbWl0KCdlcnJvcicsIGUpKVxyXG4gICAgICAgICAgLm9uKCdlbmQnLCAoKSA9PiB7XHJcbiAgICAgICAgICAgIC8vIERvIGl0IGFnYWluLCBpZiB3ZSBoYXZlbid0IGNhbmNlbGxlZCB5ZXQuXHJcbiAgICAgICAgICAgIHByb2Nlc3MubmV4dFRpY2soKCkgPT4ge1xyXG4gICAgICAgICAgICAgIHRoaXMuY2hlY2tGb3JDaGFuZ2VzKClcclxuICAgICAgICAgICAgfSlcclxuICAgICAgICAgIH0pXHJcbiAgICAgIH0sXHJcbiAgICAgIChlKSA9PiB7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMuZW1pdCgnZXJyb3InLCBlKVxyXG4gICAgICB9LFxyXG4gICAgKVxyXG4gIH1cclxufVxyXG4iXSwibWFwcGluZ3MiOiI7Ozs7O0FBZ0JBLElBQUFBLGFBQUEsR0FBQUMsT0FBQTtBQUNBLElBQUFDLE9BQUEsR0FBQUQsT0FBQTtBQUVBLElBQUFFLFFBQUEsR0FBQUYsT0FBQTtBQUVBLElBQUFHLE9BQUEsR0FBQUgsT0FBQTtBQXJCQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBU0E7O0FBSUE7QUFDTyxNQUFNSSxZQUFZLENBQUM7RUFLeEJDLEtBQUtBLENBQUNDLEVBQVcsRUFBRTtJQUNqQixJQUFJLENBQUNDLEVBQUUsR0FBR0QsRUFBRTtFQUNkO0VBRUFFLFFBQVFBLENBQUNDLFFBQWUsRUFBRTtJQUN4QixJQUFJLENBQUMsSUFBSSxDQUFDQyxLQUFLLEVBQUU7TUFDZixJQUFJLENBQUNBLEtBQUssR0FBRyxFQUFFO0lBQ2pCO0lBQ0EsSUFBSSxDQUFDQSxLQUFLLENBQUNDLElBQUksQ0FBQ0YsUUFBUSxDQUFDO0VBQzNCO0VBRUFH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O01BQ3RCRCxLQUFLLEdBQUcsR0FBR0wsT0FBTyxDQUFDTyxJQUFJLENBQUMsR0FBRyxDQUFDLEVBQUU7SUFDaEM7SUFDQSxNQUFNL0IsTUFBTSxHQUFHLElBQUksQ0FBQ2MsTUFBTSxDQUFDZCxNQUFNLElBQUlnQyx1QkFBYztJQUVuRCxJQUFJLENBQUNsQixNQUFNLENBQUNtQixnQkFBZ0IsQ0FBQztNQUFFVixNQUFNO01BQUVSLFVBQVUsRUFBRSxJQUFJLENBQUNBLFVBQVU7TUFBRWM7SUFBTSxDQUFDLEVBQUUsRUFBRSxFQUFFLENBQUMsR0FBRyxDQUFDLEVBQUU3QixNQUFNLENBQUMsQ0FBQ2tDLElBQUksQ0FDakdDLFFBQVEsSUFBSztNQUNaLE1BQU1DLEdBQUcsR0FBR0MsT0FBYyxDQUFDQyxJQUFJLENBQUMsQ0FBQztNQUVqQyxJQUFBQyxpQkFBUyxFQUFDSixRQUFRLEVBQUVDLEdBQUcsQ0FBQyxDQUNyQkksRUFBRSxDQUFDLE1BQU0sRUFBR0MsSUFBSSxJQUFLO1FBQ3BCO1FBQ0E7UUFDQSxJQUFJQyxPQUFPLEdBQUdELElBQUksQ0FBQ0UsS0FBSyxDQUFDQyxPQUFPO1FBQ2hDO1FBQ0EsSUFBSSxDQUFDRixPQUFPLEVBQUU7VUFDWkEsT0FBTyxHQUFHLEVBQUU7UUFDZDs7UUFFQTtRQUNBQSxPQUFPLENBQUNoQixPQUFPLENBQUVtQixNQUEwQixJQUFLO1VBQzlDLElBQUksQ0FBQ0MsSUFBSSxDQUFDLGNBQWMsRUFBRUQsTUFBTSxDQUFDO1FBQ25DLENBQUMsQ0FBQzs7UUFFRjtRQUNBLElBQUksSUFBSSxDQUFDNUIsTUFBTSxFQUFFO1VBQ2ZrQixRQUFRLGFBQVJBLFFBQVEsZUFBUkEsUUFBUSxDQUFFWSxPQUFPLENBQUMsQ0FBQztRQUNyQjtNQUNGLENBQUMsQ0FBQyxDQUNEUCxFQUFFLENBQUMsT0FBTyxFQUFHUSxDQUFDLElBQUssSUFBSSxDQUFDRixJQUFJLENBQUMsT0FBTyxFQUFFRSxDQUFDLENBQUMsQ0FBQyxDQUN6Q1IsRUFBRSxDQUFDLEtBQUssRUFBRSxNQUFNO1FBQ2Y7UUFDQXJCLE9BQU8sQ0FBQ0MsUUFBUSxDQUFDLE1BQU07VUFDckIsSUFBSSxDQUFDQyxlQUFlLENBQUMsQ0FBQztRQUN4QixDQUFDLENBQUM7TUFDSixDQUFDLENBQUM7SUFDTixDQUFDLEVBQ0EyQixDQUFDLElBQUs7TUFDTCxPQUFPLElBQUksQ0FBQ0YsSUFBSSxDQUFDLE9BQU8sRUFBRUUsQ0FBQyxDQUFDO0lBQzlCLENBQ0YsQ0FBQztFQUNIO0FBQ0Y7QUFBQ25FLE9BQUEsQ0FBQStCLGtCQUFBLEdBQUFBLGtCQUFBIiwiaWdub3JlTGlzdCI6W119